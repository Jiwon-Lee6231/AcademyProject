<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="course.mapper">

	<!-- resultType : 반환될 데이터타입 -->
	<select id="detail" resultType="course.CourseVO">
		SELECT *, (
			SELECT COUNT(*) 
			FROM regis_course 
			WHERE course_id = #{id }
		)
		AS regiscnt 
		FROM course 
		WHERE id = #{id }
	</select>
	
	<select id="list" resultType="course.CourseVO">
		SELECT   @ROWNUM := @ROWNUM + 1 AS no,
		         c.* 
		FROM     course c, (SELECT @ROWNUM := 0) TMP
		ORDER BY title ASC
	</select>
	
	<insert id="insert">
		INSERT INTO course(title, content, lecturer, startdate, enddate, fixednum, room, classify, writer)
		VALUES (#{title }, #{content}, #{lecturer }, #{startdate }, #{enddate }, 
				#{fixednum }, #{room }, #{classify }, '관리자')
	</insert>
	
	<update id="update">
		UPDATE course 
		SET    title=#{title }, content=#{content }, lecturer=#{lecturer }, 
		       startdate=#{startdate }, enddate=#{enddate }, fixednum=#{fixednum },
		       room=#{room }, classify=#{classify }
		WHERE  id=#{id }
	</update>
	
	<delete id="delete">
		DELETE FROM course WHERE id=#{id }
	</delete>
	
</mapper>